# 3. 함수

+ 의도를 분명히 표현하는 함수를 어떻게 구현할 수 있을까? 함수에 어떤 속성을 부여해야 처음 읽는 사람이 프로그램 내부를 직관적으로 파악할 수 있을까?

<br />

### 작게 만들어라!

+ 함수를 만드는 첫째 규칙은 '작게!'다. 함수를 만드는 둘째 규칙은 '더 작게!'다.
+ 얼마나 짧아야 좋을까? 1999년 나는 오레곤 주에 사는 켄트 벡을 방문했다. ... 켄트가 코드를 보여줬을 때 나는 함수가 너무도 작아 깜짝 놀랐다. 그때까지 나는 장황하게 긴 스윙 프로그램 함수에 익숙했다. 그런데 Sparkle은 모든 함수가 2줄, 3줄, 4줄 정도였다. **각 함수가 너무도 명백했다. 각 함수가 이야기 하나를 표현했다. 각 함수가 너무도 멋지게 다음 무대를 준비했다.** 바로 이것이 답이다!


#### 블록과 들여쓰기

+ 다시 말해, **if 문/else 문/while 문 등에 들어가는 블록은 한 줄이어야 한다**는 의미다. 대개 거기서 함수를 호출한다. 그러면 바깥을 감싸는 함수(enclosing function)가 작아질 뿐 아니라, 블록 안에서 호출하는 함수 이름을 적절히 짓는다면, 코드를 이해하기도 쉬워진다.
+ **중첩 구조가 생길만큼 함수가 커져서는 안 된다.** 함수에서 **들여쓰기 수준은 1단이나 2단을 넘어서면 안 된다.** 그래야 읽고 이해하기 쉬워진다.

<br />

### 한 가지만 해라!

> 함수는 한 가지를 해야 한다. 그 한 가지를 잘 해야 한다. 그 한 가지만을 해야 한다.

+ ① 페이지가 테스트 페이지인지 판단하고, ② 맞다면 설정 페이지와 해제 페이지를 넣고, ③ 페이지를 HTML로 렌더링하는 함수는, 한 가지만 하는가? 아니면 세 가지를 하는가?

+ **지정된 함수 이름 아래에서 추상화 수준이 하나인 단계만 수행한다면 그 함수는 한 가지 작업만 하는 것이다.**

  우리가 함수를 만드는 이유는, 큰 개념을 (다시 말해, 함수 이름을) 다음 추상화 수준에서 여러 단계로 나눠 수행하기 위해서이다.

+ 함수가 '한 가지'만 하는지 판단하는 방법이 하나 더 있다. **단순히 다른 표현이 아니라 의미 있는 이름으로 다른 함수를 추출할 수 있다면, 그 함수는 여러 작업을 하는 셈이다.**

#### 함수 내 섹션

+ 한 가지 작업만 하는 함수는 자연스럽게 섹션으로 나누기 어렵다.

<br />

### 함수 당 추상화 수준은 하나로!

+ 함수가 확실히 '한 가지' 작업만 하려면 **함수 내 모든 문장의 추상화 수준이 동일해야 한다.**
  + getHtml()은 추상화 수준이 아주 높다.
  + String pagePathName = PathParser.render(pagepath);는 추상화 수준이 중간이다.
  + .append('\n') 같은 코드는 추상화 수준이 아주 낮다.

+ 한 함수 내에 추상화 수준을 섞으면 코드를 읽는 사람이 헷갈린다. 근본 개념인지 아니면 세부 사항인지 구분하기 어려운 탓이다. 거기다 이를 뒤섞기 시작하면, 사람들이 함수에 세부사항을 점점 더 추가한다.

#### 위에서 아래로 코드 읽기: 내려가기 규칙

+ **코드는 위에서 아래로 이야기처럼 읽혀야 좋다. 한 함수 다음에는 추상화 수준이 한 단계 낮은 함수가 온다.** 위에서 아래로 프로그램을 읽으면 함수 추상화 수준이 한 번에 한 단계씩 낮아진다. **각 함수는 다음 함수를 소개한다.** 또 각 **함수는 일정한 추상화 수준을 유지**한다.

<br />

### Switch 문

+ switch 문은 작게 만들기 어렵다. 본질적으로 switch 문은 N가지를 처리한다.

+ switch 문을 완전히 피할 방법은 없다. 하지만 **다형성을 이용하여, switch 문을 저차원 클래스에 숨기고 절대로 반복하지 않는** 방법이 있다. **다형성 객체를 생성하는 코드에서 사용하는 것**이다.

  switch 문을 추상 팩토리(ABSTRACT FFACTORY)에 숨긴다. 팩토리는 **switch 문을 사용하여 주어진 추상 클래스로 적절한 파생 클래스의 인스턴스를 생성한다.** 추상 클래스의 인터페이스를 거쳐 함수들이 호출되면, 다형성으로 인해 실제로는 파생 클래스의 함수가 실행된다.

<br />
